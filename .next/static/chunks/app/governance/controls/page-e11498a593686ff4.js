(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[113],{31760:function(e,r,t){Promise.resolve().then(t.bind(t,36544))},36544:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return x}});var s=t(57437),n=t(2265),a=t(97871),l=t(20543),i=t(83639),o=t(21212),c=t(91591),d=t(70279),m=t(65174);function x(){var e,r;let{liveState:t,loading:x,error:u,lastValidation:h}=(0,a.i)(),p=(0,n.useMemo)(()=>t?(0,l.Je)(t):"NORMAL",[t]),g=(0,i.Kt)(),f=(0,o.AF)().slice(-20).reverse();if(x)return(0,s.jsx)(d.IZ,{});if(u||!t)return(0,s.jsx)(m.Z,{message:null!=u?u:"Demo Data Unavailable"});let b="NORMAL"===p?"text-green-700 bg-green-50 border-green-200":"WARNING"===p?"text-amber-700 bg-amber-50 border-amber-200":"text-red-700 bg-red-50 border-red-200";return(0,s.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,s.jsx)(c.Z,{title:"Governance — Controls",snapshotId:t.snapshot_id,timestamp:t.timestamp}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Controls & Compliance"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"border rounded-lg p-4 ".concat(b),children:[(0,s.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wider mb-1",children:"Model Drift"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:p}),(0,s.jsx)("p",{className:"text-xs mt-1 opacity-80",children:"NORMAL"===p?"All systems within parameters":"WARNING"===p?"Some parameters approaching thresholds":"Parameters outside acceptable range"})]}),(0,s.jsxs)("div",{className:"border rounded-lg p-4 ".concat((null==h?void 0:h.valid)!==!1?"text-green-700 bg-green-50 border-green-200":"text-red-700 bg-red-50 border-red-200"),children:[(0,s.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wider mb-1",children:"Validation"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:(null==h?void 0:h.valid)!==!1?"PASS":"FAIL"}),(0,s.jsxs)("p",{className:"text-xs mt-1 opacity-80",children:[null!==(e=null==h?void 0:h.errors.length)&&void 0!==e?e:0," errors, ",null!==(r=null==h?void 0:h.warnings.length)&&void 0!==r?r:0," warnings"]})]}),(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-white",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-1",children:"Pipeline Health"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:0===g.fetchErrorCount?"OK":"".concat(g.fetchErrorCount," errors")}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[g.fetchCount," fetches, ",g.snapshotRotations," rotations"]})]})]}),h&&!h.valid&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-5",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-red-800 mb-3",children:"Validation Errors"}),(0,s.jsx)("ul",{className:"space-y-1",children:h.errors.map((e,r)=>(0,s.jsxs)("li",{className:"text-sm text-red-700 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-red-400 shrink-0",children:"•"}),e]},r))})]}),h&&h.warnings.length>0&&(0,s.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-5",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-amber-800 mb-3",children:"Warnings"}),(0,s.jsx)("ul",{className:"space-y-1",children:h.warnings.map((e,r)=>(0,s.jsxs)("li",{className:"text-sm text-amber-700 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-amber-400 shrink-0",children:"•"}),e]},r))})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Appendix A — Contract Compliance"}),(0,s.jsx)("div",{className:"space-y-2",children:[{rule:"No backend / API routes",compliant:!0},{rule:"Static JSON under /public/mock/",compliant:!0},{rule:"Snapshot rotation via polling",compliant:!0},{rule:"Demo mutations in-memory only",compliant:!0},{rule:"No external network calls",compliant:!0},{rule:"No server actions",compliant:!0},{rule:"Runtime validation enabled",compliant:0===g.validationFailures}].map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2.5 py-1.5",children:[(0,s.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(e.compliant?"bg-green-500":"bg-red-500")}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e.rule})]},e.rule))})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Audit Log (Recent)"}),0===f.length?(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"No log entries"}):(0,s.jsx)("div",{className:"space-y-1 max-h-64 overflow-y-auto",children:f.map((e,r)=>(0,s.jsxs)("div",{className:"flex items-start gap-3 py-1.5 text-xs border-b border-gray-50 last:border-0",children:[(0,s.jsx)("span",{className:"font-mono text-gray-400 shrink-0 w-20 truncate",children:e.timestamp.slice(11,19)}),(0,s.jsx)("span",{className:"font-semibold uppercase shrink-0 w-12 ".concat("error"===e.level?"text-red-600":"warn"===e.level?"text-amber-600":"info"===e.level?"text-blue-600":"text-gray-400"),children:e.level}),(0,s.jsx)("span",{className:"text-gray-700 truncate",children:e.message})]},r))})]})]})]})}},20543:function(e,r,t){"use strict";t.d(r,{$A:function(){return i},Je:function(){return o},Ot:function(){return a},aD:function(){return l},ci:function(){return n}});var s=t(83639);function n(e,r,t){var n;let a=e.zones,l=a.map(e=>e.risk_score).sort((e,r)=>r-e),i=l.slice(0,Math.max(3,Math.ceil(l.length/2))),o=i.length>0?Math.round(i.reduce((e,r)=>e+r,0)/i.length*100):0,c=0,d="";for(let e of a)for(let r of e.forecast_30m)r.risk>c&&(c=r.risk,d=r.time);let m=d?"~".concat(d):"N/A",x=Math.round(100*c);return{districtRiskIndex:o,forecastedHighRiskWindow:m,forecastedHighRiskValue:x,interventionsAppliedToday:a.reduce((e,r)=>e+r.interventions.length,0),effectiveness:function(e){let r=0,t=0;for(let s of e)0!==s.interventions.length&&(t++,r+=Math.min(.12*s.interventions.length,.4));return 0===t?0:Math.round(r/t*100)}(a),governanceStatus:(n=(0,s.Kt)().fetchErrorCount,r&&r.valid&&"DRIFT"!==t&&!(n>5)?r.warnings.length>0||"WARNING"===t||n>2?"AMBER":"GREEN":"RED")}}function a(e){return e.zones.map(e=>{let r=e.forecast_30m;return{zone_id:e.zone_id,name:e.name,riskNow:Math.round(100*e.risk_score),risk15:r.length>=4?Math.round(100*r[3].risk):Math.round(100*e.risk_score),risk30:r.length>=7?Math.round(100*r[6].risk):Math.round(100*e.risk_score),risk_level:e.risk_level}})}function l(e){return e.zones.map(e=>{let r=0,t="";for(let s of e.forecast_30m)s.risk>r&&(r=s.risk,t=s.time);return{zone_id:e.zone_id,zoneName:e.name,peakRisk:r,peakTime:t}}).sort((e,r)=>r.peakRisk-e.peakRisk).slice(0,3)}function i(e){let r=[];for(let t of e.zones)for(let e of t.interventions)r.push({zone_id:t.zone_id,zoneName:t.name,action:e.action,appliedAt:e.applied_at});return r.slice(0,3)}function o(e){let r=e.camera_health_pct>=90,t=e.avg_latency_ms<=200,s=e.zones.every(e=>e.forecast_30m.length>0);return r||t?r&&t&&s?"NORMAL":"WARNING":"DRIFT"}}},function(e){e.O(0,[648,382,971,117,744],function(){return e(e.s=31760)}),_N_E=e.O()}]);