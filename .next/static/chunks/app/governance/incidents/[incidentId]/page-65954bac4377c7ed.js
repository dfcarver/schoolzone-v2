(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{84073:function(e,t,n){Promise.resolve().then(n.bind(n,13586))},13586:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var s=n(57437),r=n(2265),a=n(99376),i=n(27648),c=n(72510),l=n(65056),o=n(53375),d=n(91591);let u={detection:"bg-blue-500",intervention:"bg-green-500",alert:"bg-amber-500",incident:"bg-red-500",response:"bg-purple-500",resolution:"bg-teal-500"};function x(e){let{events:t}=e,[n,a]=(0,r.useState)(null);return t&&0!==t.length?(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Event Timeline"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute left-3 top-0 bottom-0 w-px bg-gray-200"}),(0,s.jsx)("div",{className:"space-y-4",children:t.map(e=>{let t=u[e.type]||"bg-gray-400",r=n===e.event_id,i=new Date(e.timestamp),c="".concat(String(i.getUTCHours()).padStart(2,"0"),":").concat(String(i.getUTCMinutes()).padStart(2,"0"));return(0,s.jsxs)("div",{className:"relative pl-8",children:[(0,s.jsx)("div",{className:"absolute left-1.5 top-1.5 w-3 h-3 rounded-full ".concat(t," ring-2 ring-white")}),(0,s.jsxs)("button",{onClick:()=>a(r?null:e.event_id),className:"w-full text-left",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs font-mono text-gray-400",children:c}),(0,s.jsx)("span",{className:"text-xs font-medium text-gray-500 uppercase",children:e.type})]}),(0,s.jsx)("p",{className:"text-sm text-gray-900 mt-0.5",children:e.description})]}),r&&e.payload&&(0,s.jsx)("div",{className:"mt-2 bg-gray-50 rounded-md p-3 text-xs font-mono text-gray-600 overflow-x-auto",children:(0,s.jsx)("pre",{children:JSON.stringify(e.payload,null,2)})})]},e.event_id)})})]})]}):(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"No events to display"})})}function m(e){let{incident:t}=e,n=t.model_metadata;return(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Model Provenance"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-gray-400 block",children:"Model"}),(0,s.jsx)("span",{className:"text-sm text-gray-900 font-medium",children:n.model_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-gray-400 block",children:"Version"}),(0,s.jsx)("span",{className:"text-sm text-gray-900 font-medium",children:n.model_version})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-gray-400 block",children:"Confidence"}),(0,s.jsxs)("span",{className:"text-sm text-gray-900 font-medium",children:[(100*n.prediction_confidence).toFixed(0),"%"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-gray-400 block",children:"Inference Latency"}),(0,s.jsxs)("span",{className:"text-sm text-gray-900 font-medium",children:[n.inference_latency_ms,"ms"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-gray-400 block",children:"Training Data"}),(0,s.jsx)("span",{className:"text-sm text-gray-900 font-medium",children:n.training_data_range})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-gray-400 block",children:"Features Used"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:n.features_used.map(e=>(0,s.jsx)("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:e},e))})]})]})]})}var f=n(70279),g=n(65174);let h={LOW:"bg-green-100 text-green-700",MED:"bg-amber-100 text-amber-700",HIGH:"bg-red-100 text-red-700"},p={investigating:"bg-red-50 text-red-600",monitoring:"bg-amber-50 text-amber-600",resolved:"bg-green-50 text-green-600"};function v(){let e=(0,a.useParams)().incidentId,{config:t}=(0,l.c)(),[n,u]=(0,r.useState)(null),[v,j]=(0,r.useState)(!0),[b,y]=(0,r.useState)(null);return((0,r.useEffect)(()=>{let n=!1;return j(!0),(0,c.uq)(t.scenario).then(t=>{if(!n){if(t.error)y(t.error);else{let n=t.data.find(t=>t.incident_id===e);n?u(n):y('Incident "'.concat(e,'" not found'))}j(!1)}}),()=>{n=!0}},[e,t.scenario]),v)?(0,s.jsx)(f.IZ,{}):b||!n?(0,s.jsx)(g.Z,{message:null!=b?b:"Demo Data Unavailable",backHref:"/governance/incidents",backLabel:"Back to Incidents"}):(0,s.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,s.jsx)(d.Z,{title:"Incident Detail"}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(i.default,{href:"/governance/incidents",className:"text-sm text-gray-400 hover:text-gray-600",children:"Incidents"}),(0,s.jsx)("span",{className:"text-gray-300",children:"/"}),(0,s.jsx)("span",{className:"text-sm text-gray-900 font-medium",children:n.incident_id})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-lg font-semibold text-gray-900 mb-2",children:n.title}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-xs font-mono text-gray-400",children:n.incident_id}),(0,s.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full ".concat(h[n.severity]||""),children:n.severity}),(0,s.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full ".concat(p[n.status]||"bg-gray-100 text-gray-600"),children:n.status}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:n.zone_name})]})]}),(0,s.jsx)("button",{onClick:()=>(0,o.j)(n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Export JSON"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:n.summary}),(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-4 text-xs text-gray-400",children:[(0,s.jsxs)("span",{children:["Type: ",(0,s.jsx)("span",{className:"text-gray-600",children:n.type})]}),(0,s.jsxs)("span",{children:["Reported: ",(0,s.jsx)("span",{className:"text-gray-600",children:function(e){let t=new Date(e),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getUTCMonth()],s=t.getUTCDate(),r=t.getUTCFullYear(),a=String(t.getUTCHours()).padStart(2,"0"),i=String(t.getUTCMinutes()).padStart(2,"0");return"".concat(n," ").concat(s,", ").concat(r," ").concat(a,":").concat(i," UTC")}(n.reported_at)})]})]})]}),(0,s.jsx)(x,{events:n.events}),(0,s.jsx)(m,{incident:n})]})]})}},65174:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(57437),r=n(27648);function a(e){let{message:t="Demo Data Unavailable",backHref:n,backLabel:a="Go Back"}=e;return(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-red-50 flex items-center justify-center mx-auto mb-3",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("p",{className:"text-sm text-red-500 mb-2",children:t}),n&&(0,s.jsx)(r.default,{href:n,className:"text-sm text-blue-600 hover:underline",children:a})]})})}},70279:function(e,t,n){"use strict";n.d(t,{IZ:function(){return r}});var s=n(57437);function r(){return(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:"Loading..."})]})})}},91591:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var s=n(57437),r=n(65056);let a={normal:"Normal",surge:"Surge",weather:"Weather",dismissal:"Dismissal"};function i(e){let{snapshotId:t,timestamp:n,title:i="Operations Console"}=e,{config:c,updateConfig:l}=(0,r.c)(),o=n?function(e){let t=new Date(e),n=String(t.getUTCHours()).padStart(2,"0"),s=String(t.getUTCMinutes()).padStart(2,"0"),r=String(t.getUTCSeconds()).padStart(2,"0");return"".concat(n,":").concat(s,":").concat(r," UTC")}(n):"--:--:--";return(0,s.jsxs)("header",{className:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-6 shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h1",{className:"text-sm font-semibold text-gray-900",children:i}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"|"}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Snapshot: ",t]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("select",{value:c.scenario,onChange:e=>l({scenario:e.target.value}),className:"text-xs border border-gray-200 rounded-md px-2 py-1 text-gray-600 bg-white",children:Object.keys(a).map(e=>(0,s.jsx)("option",{value:e,children:a[e]},e))}),(0,s.jsx)("button",{onClick:()=>l({timeMode:"live"===c.timeMode?"paused":"live"}),className:"flex items-center gap-1.5 text-xs px-2 py-1 rounded-md border ".concat("live"===c.timeMode?"border-green-200 bg-green-50 text-green-700":"border-amber-200 bg-amber-50 text-amber-700"),children:"live"===c.timeMode?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,s.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),(0,s.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),"Live"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"inline-flex rounded-full h-2 w-2 bg-amber-500"}),"Paused"]})}),(0,s.jsx)("span",{className:"text-xs font-mono text-gray-600",children:o})]})]})}},72510:function(e,t,n){"use strict";n.d(t,{SE:function(){return i},uq:function(){return c}});var s=n(65056),r=n(21212),a=n(83639);async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",n=arguments.length>2?arguments[2]:void 0,i=performance.now();try{let c=await fetch("".concat((0,s.f)(t),"/").concat(e),{signal:n});if(!c.ok)throw Error("Failed to load live state: ".concat(c.status));let l=await c.json();return(0,a._h)(performance.now()-i,!0),r.um("Loaded snapshot ".concat(e," (").concat(t,")")),l}catch(e){return"AbortError"!==e.name&&(r.vU("loadLiveState failed",e),(0,a._h)(performance.now()-i,!1)),null}}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=arguments.length>1?arguments[1]:void 0,n=performance.now();try{let r=await fetch("".concat((0,s.f)(e),"/incidents.json"),{signal:t});if(!r.ok)throw Error("Failed to load incidents: ".concat(r.status));let i=await r.json();return(0,a._h)(performance.now()-n,!0),{data:i,error:null}}catch(e){return"AbortError"!==e.name&&(r.vU("loadIncidents failed",e),(0,a._h)(performance.now()-n,!1)),{data:[],error:"Demo Data Unavailable"}}}},65056:function(e,t,n){"use strict";n.d(t,{DemoConfigProvider:function(){return o},c:function(){return l},f:function(){return d}});var s=n(57437),r=n(2265);let a={scenario:"normal",snapshotIntervalMs:5e3,timeMode:"live",demoMutationEnabled:!0,runtimeValidationEnabled:!0},i="schoolzone-demo-config",c=(0,r.createContext)({config:a,updateConfig:()=>{}});function l(){return(0,r.useContext)(c)}function o(e){let{children:t}=e,[n,l]=(0,r.useState)(a);(0,r.useEffect)(()=>{l(function(){try{let e=localStorage.getItem(i);if(!e)return a;let t=JSON.parse(e);return{...a,...t}}catch(e){return a}}())},[]);let o=(0,r.useCallback)(e=>{l(t=>{let n={...t,...e};return!function(e){try{localStorage.setItem(i,JSON.stringify(e))}catch(e){}}(n),n})},[]);return(0,s.jsx)(c.Provider,{value:{config:n,updateConfig:o},children:t})}function d(e){return"/mock/scenarios/".concat(e)}},53375:function(e,t,n){"use strict";function s(e,t){let n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}function r(e){s(e,"".concat(e.incident_id,".json"))}function a(e){s({generated_at:new Date().toISOString(),district_risk_index:e.districtRiskIndex,forecasted_high_risk_window:e.forecastedHighRiskWindow,forecasted_high_risk_value:e.forecastedHighRiskValue,interventions_applied_today:e.interventionsAppliedToday,effectiveness_pct:e.effectiveness,governance_status:e.governanceStatus},"executive-summary-".concat(Date.now(),".json"))}n.d(t,{M:function(){return a},j:function(){return r}})},21212:function(e,t,n){"use strict";n.d(t,{AF:function(){return o},ZK:function(){return c},um:function(){return i},vU:function(){return l}});let s=[];function r(){return new Date().toISOString()}function a(e){s.push(e),s.length>200&&s.shift()}function i(e,t){a({level:"info",timestamp:r(),message:e,data:t})}function c(e,t){a({level:"warn",timestamp:r(),message:e,data:t})}function l(e,t){a({level:"error",timestamp:r(),message:e,data:t})}function o(){return s}},83639:function(e,t,n){"use strict";n.d(t,{Kt:function(){return l},L8:function(){return i},_h:function(){return r},sv:function(){return c},vP:function(){return a}});let s={fetchCount:0,fetchErrorCount:0,lastFetchMs:0,lastFetchAt:null,snapshotRotations:0,demoMutationsApplied:0,validationFailures:0};function r(e,t){s.fetchCount++,s.lastFetchMs=e,s.lastFetchAt=new Date().toISOString(),!t&&s.fetchErrorCount++}function a(){s.snapshotRotations++}function i(){s.demoMutationsApplied++}function c(){s.validationFailures++}function l(){return{...s}}},99376:function(e,t,n){"use strict";var s=n(35475);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=84073)}),_N_E=e.O()}]);