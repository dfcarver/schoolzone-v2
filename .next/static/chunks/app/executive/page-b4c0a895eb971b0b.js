(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[942],{7293:function(e,t,s){Promise.resolve().then(s.bind(s,91568))},91568:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var r=s(57437),n=s(2265),a=s(97871),i=s(91591);let l={GREEN:{border:"border-green-300",dot:"bg-green-500"},AMBER:{border:"border-amber-300",dot:"bg-amber-500"},RED:{border:"border-red-400",dot:"bg-red-500"}};function c(e){let{label:t,value:s,subtitle:n,governanceStatus:a}=e,i=a?l[a]:{border:"border-gray-200",dot:"bg-blue-500"};return(0,r.jsxs)("div",{className:"bg-white rounded-lg border ".concat(i.border," px-5 py-4 flex flex-col gap-1"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(i.dot)}),(0,r.jsx)("span",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:t})]}),(0,r.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:s}),n&&(0,r.jsx)("span",{className:"text-xs text-gray-500",children:n})]})}var o=s(99376);function d(e){let{entries:t,linkPrefix:s="/executive/zones"}=e,[a,i]=(0,n.useState)("NOW"),l=(0,o.useRouter)();return(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Portfolio Heatmap"}),(0,r.jsx)("div",{className:"flex items-center gap-1 bg-gray-100 rounded-lg p-0.5",children:["NOW","+15","+30"].map(e=>(0,r.jsx)("button",{onClick:()=>i(e),className:"text-xs font-medium px-3 py-1 rounded-md transition-colors ".concat(a===e?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"),children:e},e))})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:t.map(e=>{let t=function(e){switch(a){case"NOW":return e.riskNow;case"+15":return e.risk15;case"+30":return e.risk30}}(e);return(0,r.jsxs)("button",{onClick:()=>l.push("".concat(s,"/").concat(e.zone_id)),className:"text-left border rounded-lg p-3 hover:shadow-md transition-shadow cursor-pointer ".concat(t>=60?"bg-red-50 border-red-200":t>=40?"bg-amber-50 border-amber-200":"bg-green-50 border-green-200"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,r.jsx)("span",{className:"w-3 h-3 rounded-full ".concat(t>=60?"bg-red-500":t>=40?"bg-amber-400":"bg-green-500")})]}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[t,"%"]}),(0,r.jsxs)("div",{className:"text-[10px] text-gray-500 uppercase mt-1",children:["Risk ","NOW"===a?"Now":"at ".concat(a," min")]})]},e.zone_id)})})]})}function x(e){let{liveState:t}=e,s=t.zones.filter(e=>e.interventions.length>0).sort((e,t)=>t.interventions.length-e.interventions.length)[0];if(!s)return(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Impact Analysis"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"No interventions applied yet to measure impact."})]});let n=Math.round(100*s.forecast_30m.reduce((e,t)=>t.risk>e?t.risk:e,0)),a=Math.round(100*s.risk_score),i=n-a,l=Math.round(s.vehicle_count/Math.max(s.speed_avg_mph,1)*3),c=Math.round(a/Math.max(n,1)*l);return(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Impact Analysis"}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mb-4",children:[s.name," — ",s.interventions.length," intervention",1!==s.interventions.length?"s":""," applied"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-medium text-gray-400 uppercase tracking-wider mb-3",children:"Risk Score"}),(0,r.jsxs)("div",{className:"flex items-end gap-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-red-500",children:[n,"%"]}),(0,r.jsx)("div",{className:"text-[10px] text-gray-400 mt-1",children:"Before"})]}),(0,r.jsx)("div",{className:"text-gray-300 text-lg pb-1",children:"→"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[a,"%"]}),(0,r.jsx)("div",{className:"text-[10px] text-gray-400 mt-1",children:"Current"})]}),i>0&&(0,r.jsx)("div",{className:"pb-1",children:(0,r.jsxs)("span",{className:"text-sm font-semibold text-green-600",children:["-",i,"%"]})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-medium text-gray-400 uppercase tracking-wider mb-3",children:"Congestion Index"}),(0,r.jsxs)("div",{className:"flex items-end gap-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-amber-500",children:l}),(0,r.jsx)("div",{className:"text-[10px] text-gray-400 mt-1",children:"Before"})]}),(0,r.jsx)("div",{className:"text-gray-300 text-lg pb-1",children:"→"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:c}),(0,r.jsx)("div",{className:"text-[10px] text-gray-400 mt-1",children:"Current"})]})]})]})]})]})}var m=s(70279),u=s(65174),g=s(20543),h=s(53375);function p(){let{liveState:e,loading:t,error:s,lastValidation:l}=(0,a.i)(),o=(0,n.useMemo)(()=>{if(!e)return null;let t=(0,g.Je)(e);return(0,g.ci)(e,l,t)},[e,l]),p=(0,n.useMemo)(()=>e?(0,g.Ot)(e):[],[e]),f=(0,n.useMemo)(()=>e?(0,g.aD)(e):[],[e]),b=(0,n.useMemo)(()=>e?(0,g.$A)(e):[],[e]);return t?(0,r.jsx)(m.IZ,{}):!s&&e&&o?(0,r.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,r.jsx)(i.Z,{title:"Executive Command Brief",snapshotId:e.snapshot_id,timestamp:e.timestamp}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,r.jsx)(c,{label:"District Risk",value:o.districtRiskIndex,subtitle:"Risk index (0–100)",governanceStatus:o.governanceStatus}),(0,r.jsx)(c,{label:"High-Risk Window",value:o.forecastedHighRiskWindow,subtitle:"Peak: ".concat(o.forecastedHighRiskValue,"%")}),(0,r.jsx)(c,{label:"Interventions",value:o.interventionsAppliedToday,subtitle:"Applied today"}),(0,r.jsx)(c,{label:"Effectiveness",value:"".concat(o.effectiveness,"%"),subtitle:"Avg risk reduction"}),(0,r.jsx)(c,{label:"Governance",value:o.governanceStatus,governanceStatus:o.governanceStatus}),(0,r.jsx)(c,{label:"Active Alerts",value:e.active_alerts,subtitle:"".concat(e.zones.length," zones monitored")})]}),(0,r.jsx)(d,{entries:p}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Emerging Risks"}),0===f.length?(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"No emerging risks detected"}):(0,r.jsx)("div",{className:"space-y-3",children:f.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-50 last:border-0",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.zoneName}),(0,r.jsxs)("span",{className:"text-xs text-gray-400 ml-2",children:["peaks at ",e.peakTime]})]}),(0,r.jsxs)("span",{className:"text-sm font-bold ".concat(e.peakRisk>=.7?"text-red-600":e.peakRisk>=.4?"text-amber-600":"text-green-600"),children:[Math.round(100*e.peakRisk),"%"]})]},e.zone_id))})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Active Mitigations"}),0===b.length?(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"No active mitigations"}):(0,r.jsx)("div",{className:"space-y-3",children:b.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-start justify-between py-2 border-b border-gray-50 last:border-0",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900 block truncate",children:e.action}),(0,r.jsxs)("span",{className:"text-xs text-gray-400",children:[e.zoneName," — ",e.appliedAt]})]}),(0,r.jsx)("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full shrink-0 ml-2",children:"Active"})]},"".concat(e.zone_id,"-").concat(t)))})]})]}),(0,r.jsx)(x,{liveState:e}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{onClick:()=>(0,h.M)(o),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Export Summary JSON"})})]})]}):(0,r.jsx)(u.Z,{message:null!=s?s:"Demo Data Unavailable"})}},53375:function(e,t,s){"use strict";function r(e,t){let s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(s),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}function n(e){r(e,"".concat(e.incident_id,".json"))}function a(e){r({generated_at:new Date().toISOString(),district_risk_index:e.districtRiskIndex,forecasted_high_risk_window:e.forecastedHighRiskWindow,forecasted_high_risk_value:e.forecastedHighRiskValue,interventions_applied_today:e.interventionsAppliedToday,effectiveness_pct:e.effectiveness,governance_status:e.governanceStatus},"executive-summary-".concat(Date.now(),".json"))}s.d(t,{M:function(){return a},j:function(){return n}})},20543:function(e,t,s){"use strict";s.d(t,{$A:function(){return l},Je:function(){return c},Ot:function(){return a},aD:function(){return i},ci:function(){return n}});var r=s(83639);function n(e,t,s){var n;let a=e.zones,i=a.map(e=>e.risk_score).sort((e,t)=>t-e),l=i.slice(0,Math.max(3,Math.ceil(i.length/2))),c=l.length>0?Math.round(l.reduce((e,t)=>e+t,0)/l.length*100):0,o=0,d="";for(let e of a)for(let t of e.forecast_30m)t.risk>o&&(o=t.risk,d=t.time);let x=d?"~".concat(d):"N/A",m=Math.round(100*o);return{districtRiskIndex:c,forecastedHighRiskWindow:x,forecastedHighRiskValue:m,interventionsAppliedToday:a.reduce((e,t)=>e+t.interventions.length,0),effectiveness:function(e){let t=0,s=0;for(let r of e)0!==r.interventions.length&&(s++,t+=Math.min(.12*r.interventions.length,.4));return 0===s?0:Math.round(t/s*100)}(a),governanceStatus:(n=(0,r.Kt)().fetchErrorCount,t&&t.valid&&"DRIFT"!==s&&!(n>5)?t.warnings.length>0||"WARNING"===s||n>2?"AMBER":"GREEN":"RED")}}function a(e){return e.zones.map(e=>{let t=e.forecast_30m;return{zone_id:e.zone_id,name:e.name,riskNow:Math.round(100*e.risk_score),risk15:t.length>=4?Math.round(100*t[3].risk):Math.round(100*e.risk_score),risk30:t.length>=7?Math.round(100*t[6].risk):Math.round(100*e.risk_score),risk_level:e.risk_level}})}function i(e){return e.zones.map(e=>{let t=0,s="";for(let r of e.forecast_30m)r.risk>t&&(t=r.risk,s=r.time);return{zone_id:e.zone_id,zoneName:e.name,peakRisk:t,peakTime:s}}).sort((e,t)=>t.peakRisk-e.peakRisk).slice(0,3)}function l(e){let t=[];for(let s of e.zones)for(let e of s.interventions)t.push({zone_id:s.zone_id,zoneName:s.name,action:e.action,appliedAt:e.applied_at});return t.slice(0,3)}function c(e){let t=e.camera_health_pct>=90,s=e.avg_latency_ms<=200,r=e.zones.every(e=>e.forecast_30m.length>0);return t||s?t&&s&&r?"NORMAL":"WARNING":"DRIFT"}},99376:function(e,t,s){"use strict";var r=s(35475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})}},function(e){e.O(0,[648,382,971,117,744],function(){return e(e.s=7293)}),_N_E=e.O()}]);